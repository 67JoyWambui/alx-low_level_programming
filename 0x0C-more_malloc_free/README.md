THIS IS MORE MALLOC AND FREE FUNCTIONS
